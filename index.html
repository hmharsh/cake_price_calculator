<html>
<head>
    <title>Price calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<script src="itemDetails.js"></script>
<body>
<h1>Cake Price Calculator</h1>
<select id="selectIng">
    <option>Choose a ingredient</option>
</select>
<hr/>
<div id="ingredientDetails">
    Ingredient Name: <span id="name"></span> <br/> <br/> 
    Measurement unit: <span id="unit"></span> <br/> <br/>
    Price per unit in ₹: <span id="price"></span> <br/> <br/>
    Brand: <span id="brand"></span> <br/> <br/>
    Comments: <span id="comment"></span> <br/> <br/> 
    <hr/>
    Ingredient quantity in <label id="perUnit"> </label>: <input type="number" step="0.01" onkeyup="changeQuantity(this.value)" id="quantity"> <br/><br/>
    Price of Ingredient in ₹: <span id="ingredientPrice"></span> <br/> <br/>
    <button type="button"  onclick="addIngredient()">Add</button><br/><br/>
    Total Price: <span id="totalPrice"></span><br/><br/>
</div>

<script>
    // On load
    var Result = []
    var totalPrice=0
    window.onload = function() {
    document.getElementById("ingredientDetails").style.display='none';
    document.getElementById("name").innerHTML = "";
    document.getElementById("unit").innerHTML = "";
    document.getElementById("perUnit").innerHTML = "";
    document.getElementById("price").innerHTML = "";
    document.getElementById("brand").innerHTML = "";
    document.getElementById("comment").innerHTML = "";
    document.getElementById("totalPrice").innerHTML = totalPrice;
    };

    // Get drop down populated with ingredient name
    var select = document.getElementById("selectIng");
    for(var i = 0; i < itemDetails.length; i++) {
        var opt = itemDetails[i].name;
        var el = document.createElement("option");
        el.textContent = opt;
        el.value = opt;
        select.appendChild(el);
    }

    // On select change
    document.getElementById('selectIng').addEventListener('change', function() {
    document.getElementById("ingredientDetails").style.display='block';
    document.getElementById("quantity").value = "";
    for(var i = 0; i < itemDetails.length; i++) {
        if (this.value == itemDetails[i].name) {
            document.getElementById("name").innerHTML = itemDetails[i].name;
            document.getElementById("unit").innerHTML = itemDetails[i].unit;
            document.getElementById("perUnit").innerHTML = itemDetails[i].unit;
            document.getElementById("price").innerHTML = itemDetails[i].price;
            document.getElementById("brand").innerHTML = itemDetails[i].brand;
        }
    }
    document.getElementById("ingredientPrice").innerHTML=0
    });

    // On change in Quantity
    function changeQuantity(newQuantity){
        document.getElementById("ingredientPrice").innerHTML = (parseFloat(document.getElementById('price').innerHTML)*parseFloat(document.getElementById("quantity").value))
    }

    // On add button click
    function addIngredient(){
        Result.push(
            {
                "name": document.getElementById("name").innerHTML,
                "price": parseFloat(document.getElementById('price').innerHTML)*document.getElementById("quantity").value
            }  
        )
        document.getElementById("totalPrice").innerHTML = parseFloat(document.getElementById('totalPrice').innerHTML)  + parseFloat(document.getElementById("ingredientPrice").innerHTML);
        console.table(Result)
    }

</script>
</body>
</html>